# ğŸ“± Ø¯Ù„ÙŠÙ„ Ø±Ø¨Ø· Flutter Ù…Ø¹ Ø§Ù„Ù€ Backend

Ù‡Ø°Ø§ Ø§Ù„Ù…Ø¬Ù„Ø¯ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰ ØªÙˆØ«ÙŠÙ‚ Ø´Ø§Ù…Ù„ Ù„ÙƒÙŠÙÙŠØ© Ø±Ø¨Ø· ØªØ·Ø¨ÙŠÙ‚ Flutter Ù…Ø¹ Ø§Ù„Ù€ Backend API.

## ğŸ“‚ Ø§Ù„Ù‡ÙŠÙƒÙ„

```
flutter-integration/
â”œâ”€â”€ README.md           # Ù‡Ø°Ø§ Ø§Ù„Ù…Ù„Ù
â”œâ”€â”€ auth.md             # Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„ØªØ³Ø¬ÙŠÙ„
â”œâ”€â”€ products.md         # Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª
â”œâ”€â”€ catalog.md          # Ø§Ù„ÙƒØ§ØªØ§Ù„ÙˆØ¬ (Ø§Ù„ÙØ¦Ø§Øª ÙˆØ§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©)
â”œâ”€â”€ orders.md           # Ø§Ù„Ø·Ù„Ø¨Ø§Øª ÙˆØ§Ù„Ø³Ù„Ø©
â”œâ”€â”€ customers.md        # Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¹Ù…ÙŠÙ„ ÙˆØ§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†
â”œâ”€â”€ notifications.md    # Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§Øª
â”œâ”€â”€ wallet.md           # Ø§Ù„Ù…Ø­ÙØ¸Ø© ÙˆÙ†Ø¸Ø§Ù… Ø§Ù„ÙˆÙ„Ø§Ø¡
â”œâ”€â”€ locations.md        # Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙˆØ§Ù„Ù…Ø¯Ù† ÙˆÙ…Ù†Ø§Ø·Ù‚ Ø§Ù„Ø´Ø­Ù†
â”œâ”€â”€ returns.md          # Ø§Ù„Ù…Ø±ØªØ¬Ø¹Ø§Øª
â”œâ”€â”€ promotions.md       # Ø§Ù„Ø¹Ø±ÙˆØ¶ ÙˆØ§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª
â””â”€â”€ support.md          # Ø§Ù„Ø¯Ø¹Ù… Ø§Ù„ÙÙ†ÙŠ ÙˆØ§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©
```

## ğŸ“‹ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù€ Modules

| Module | Ù…Ù„Ù Ø§Ù„ØªÙˆØ«ÙŠÙ‚ | Ø§Ù„ÙˆØµÙ |
|--------|-------------|-------|
| ğŸ” Auth | [auth.md](./auth.md) | Ø§Ù„ØªØ³Ø¬ÙŠÙ„ØŒ ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ØŒ OTPØŒ ØªØ­Ø¯ÙŠØ« Ø§Ù„ØªÙˆÙƒÙ† |
| ğŸ“¦ Products | [products.md](./products.md) | Ø¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§ØªØŒ Ø§Ù„Ø¨Ø­Ø«ØŒ Ø§Ù„ØªÙØ§ØµÙŠÙ„ØŒ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø§Øª |
| ğŸ“‚ Catalog | [catalog.md](./catalog.md) | Ø§Ù„ÙØ¦Ø§ØªØŒ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª Ø§Ù„ØªØ¬Ø§Ø±ÙŠØ©ØŒ Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„Ø£Ø³Ø¹Ø§Ø± |
| ğŸ›’ Orders | [orders.md](./orders.md) | Ø§Ù„Ø³Ù„Ø©ØŒ Ø¥Ù†Ø´Ø§Ø¡ Ø§Ù„Ø·Ù„Ø¨Ø§ØªØŒ Ø§Ù„ØªØªØ¨Ø¹ |
| ğŸ‘¤ Customers | [customers.md](./customers.md) | Ø§Ù„Ù…Ù„Ù Ø§Ù„Ø´Ø®ØµÙŠØŒ Ø§Ù„Ø¹Ù†Ø§ÙˆÙŠÙ†ØŒ Ø§Ù„Ù…ÙØ¶Ù„Ø© |
| ğŸ”” Notifications | [notifications.md](./notifications.md) | Ø§Ù„Ø¥Ø´Ø¹Ø§Ø±Ø§ØªØŒ FCM Token |
| ğŸ’° Wallet | [wallet.md](./wallet.md) | Ø§Ù„Ù…Ø­ÙØ¸Ø©ØŒ Ù†Ù‚Ø§Ø· Ø§Ù„ÙˆÙ„Ø§Ø¡ØŒ Ø§Ù„Ù…Ø³ØªÙˆÙŠØ§Øª |
| ğŸ“ Locations | [locations.md](./locations.md) | Ø§Ù„Ù…Ø¯Ù†ØŒ Ø§Ù„Ø£Ø­ÙŠØ§Ø¡ØŒ Ø­Ø³Ø§Ø¨ Ø§Ù„Ø´Ø­Ù† |
| ğŸ”„ Returns | [returns.md](./returns.md) | Ø·Ù„Ø¨Ø§Øª Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ØŒ Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ |
| ğŸ Promotions | [promotions.md](./promotions.md) | Ø§Ù„Ø¹Ø±ÙˆØ¶ØŒ Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§ØªØŒ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„ØµÙ„Ø§Ø­ÙŠØ© |
| ğŸ§ Support | [support.md](./support.md) | Ø§Ù„ØªØ°Ø§ÙƒØ±ØŒ Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø© Ø§Ù„Ù…Ø¨Ø§Ø´Ø±Ø©ØŒ Ø§Ù„ØªÙ‚ÙŠÙŠÙ… |

## ğŸ”— Base URL

```dart
const String baseUrl = 'https://api.example.com/v1';
```

## ğŸ“¦ Ø´ÙƒÙ„ Ø§Ù„Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù‚ÙŠØ§Ø³ÙŠ

Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù€ API endpoints ØªØ±Ø¬Ø¹ Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø¨Ù‡Ø°Ø§ Ø§Ù„Ø´ÙƒÙ„:

```dart
class ApiResponse<T> {
  final bool success;
  final T? data;
  final String message;
  final String messageAr;
  final dynamic error;
  
  ApiResponse({
    required this.success,
    this.data,
    required this.message,
    required this.messageAr,
    this.error,
  });
  
  factory ApiResponse.fromJson(
    Map<String, dynamic> json,
    T Function(Map<String, dynamic>)? fromJsonT,
  ) {
    return ApiResponse(
      success: json['success'] ?? false,
      data: json['data'] != null && fromJsonT != null 
          ? fromJsonT(json['data']) 
          : json['data'],
      message: json['message'] ?? '',
      messageAr: json['messageAr'] ?? '',
      error: json['error'],
    );
  }
}
```

## ğŸ” Ø¥Ø¹Ø¯Ø§Ø¯ Dio / HTTP Client

```dart
import 'package:dio/dio.dart';

class ApiClient {
  late Dio _dio;
  String? _accessToken;
  String? _refreshToken;
  
  ApiClient() {
    _dio = Dio(BaseOptions(
      baseUrl: baseUrl,
      connectTimeout: const Duration(seconds: 30),
      receiveTimeout: const Duration(seconds: 30),
      headers: {
        'Content-Type': 'application/json',
        'Accept': 'application/json',
      },
    ));
    
    // Ø¥Ø¶Ø§ÙØ© Interceptor Ù„Ù„Ù€ Token
    _dio.interceptors.add(InterceptorsWrapper(
      onRequest: (options, handler) {
        if (_accessToken != null) {
          options.headers['Authorization'] = 'Bearer $_accessToken';
        }
        return handler.next(options);
      },
      onError: (error, handler) async {
        if (error.response?.statusCode == 401 && _refreshToken != null) {
          // Ù…Ø­Ø§ÙˆÙ„Ø© ØªØ­Ø¯ÙŠØ« Ø§Ù„Ù€ Token
          try {
            await _refreshAccessToken();
            // Ø¥Ø¹Ø§Ø¯Ø© Ù…Ø­Ø§ÙˆÙ„Ø© Ø§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø£ØµÙ„ÙŠ
            final opts = error.requestOptions;
            opts.headers['Authorization'] = 'Bearer $_accessToken';
            final response = await _dio.fetch(opts);
            return handler.resolve(response);
          } catch (e) {
            // ÙØ´Ù„ Ø§Ù„ØªØ­Ø¯ÙŠØ« - ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            logout();
          }
        }
        return handler.next(error);
      },
    ));
  }
  
  Future<void> _refreshAccessToken() async {
    final response = await _dio.post('/auth/refresh', data: {
      'refreshToken': _refreshToken,
    });
    
    if (response.data['success']) {
      _accessToken = response.data['data']['accessToken'];
      _refreshToken = response.data['data']['refreshToken'];
      // Ø­ÙØ¸ Ø§Ù„Ù€ tokens ÙÙŠ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
    }
  }
  
  void setTokens(String accessToken, String refreshToken) {
    _accessToken = accessToken;
    _refreshToken = refreshToken;
  }
  
  void logout() {
    _accessToken = null;
    _refreshToken = null;
    // Ù…Ø³Ø­ Ø§Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
  }
}
```

## ğŸ”’ Ø§Ù„Ù€ Endpoints Ø­Ø³Ø¨ Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©

### ğŸŒ Public Endpoints (Ø¨Ø¯ÙˆÙ† Token)

Ù‡Ø°Ù‡ Ø§Ù„Ù€ endpoints Ù„Ø§ ØªØ­ØªØ§Ø¬ ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„:

| Endpoint | Ø§Ù„ÙˆØµÙ |
|----------|-------|
| `POST /auth/register` | Ø§Ù„ØªØ³Ø¬ÙŠÙ„ |
| `POST /auth/login` | ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ |
| `POST /auth/verify-otp` | Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† OTP |
| `GET /catalog/*` | Ø§Ù„ÙƒØ§ØªØ§Ù„ÙˆØ¬ (Ø§Ù„ÙØ¦Ø§ØªØŒ Ø§Ù„Ø¹Ù„Ø§Ù…Ø§Øª) |
| `GET /products` | Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª |
| `GET /products/:id` | ØªÙØ§ØµÙŠÙ„ Ù…Ù†ØªØ¬ |
| `GET /promotions/active` | Ø§Ù„Ø¹Ø±ÙˆØ¶ Ø§Ù„Ù†Ø´Ø·Ø© |
| `GET /promotions/coupons/public` | Ø§Ù„ÙƒÙˆØ¨ÙˆÙ†Ø§Øª Ø§Ù„Ø¹Ø§Ù…Ø© |
| `GET /locations/*` | Ø§Ù„Ù…ÙˆØ§Ù‚Ø¹ ÙˆØ§Ù„Ù…Ø¯Ù† |
| `GET /returns/reasons` | Ø£Ø³Ø¨Ø§Ø¨ Ø§Ù„Ø¥Ø±Ø¬Ø§Ø¹ |
| `GET /tickets/categories` | ÙØ¦Ø§Øª Ø§Ù„ØªØ°Ø§ÙƒØ± |
| `GET /wallet/tiers` | Ù…Ø³ØªÙˆÙŠØ§Øª Ø§Ù„ÙˆÙ„Ø§Ø¡ |

### ğŸ”’ Protected Endpoints (ØªØ­ØªØ§Ø¬ Token)

Ø¨Ù‚ÙŠØ© Ø§Ù„Ù€ endpoints ØªØ­ØªØ§Ø¬ `Authorization: Bearer <token>`

## ğŸš€ Ø§Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø³Ø±ÙŠØ¹

1. **Ø§Ø¨Ø¯Ø£ Ø¨Ø§Ù„Ù…ØµØ§Ø¯Ù‚Ø©**: Ø§Ù‚Ø±Ø£ [auth.md](./auth.md) Ù„ÙÙ‡Ù… Ù†Ø¸Ø§Ù… Ø§Ù„ØªØ³Ø¬ÙŠÙ„ ÙˆØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
2. **Ø§Ø³ØªØ¹Ø±Ø¶ Ø§Ù„Ù…Ù†ØªØ¬Ø§Øª**: Ø§Ù‚Ø±Ø£ [products.md](./products.md) Ùˆ [catalog.md](./catalog.md)
3. **Ø£Ù†Ø´Ø¦ Ø§Ù„Ø·Ù„Ø¨Ø§Øª**: Ø§Ù‚Ø±Ø£ [orders.md](./orders.md) Ù„ÙÙ‡Ù… Ø§Ù„Ø³Ù„Ø© ÙˆØ§Ù„Ø·Ù„Ø¨Ø§Øª
4. **Ø£Ø¶Ù Ø§Ù„Ù…ÙŠØ²Ø§Øª Ø§Ù„Ø¥Ø¶Ø§ÙÙŠØ©**: WalletØŒ PromotionsØŒ Support Ø­Ø³Ø¨ Ø§Ù„Ø­Ø§Ø¬Ø©

## ğŸ“ ÙƒÙ„ Ù…Ù„Ù ØªÙˆØ«ÙŠÙ‚ ÙŠØ­ØªÙˆÙŠ Ø¹Ù„Ù‰:

- âœ… **Flutter Models** ÙƒØ§Ù…Ù„Ø© Ù…Ø¹ `fromJson`
- âœ… **Enums** Ù…Ø¹ Ø§Ù„ØªØ±Ø¬Ù…Ø© Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©
- âœ… **API Endpoints** Ù…ÙØµÙ„Ø©
- âœ… **Request/Response** Ø£Ù…Ø«Ù„Ø©
- âœ… **Service class** Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…
- âœ… **Ø£Ù…Ø«Ù„Ø© UI** Ø¹Ù…Ù„ÙŠØ©
- âœ… **Ø§Ù„Ø£Ø®Ø·Ø§Ø¡ Ø§Ù„Ù…Ø­ØªÙ…Ù„Ø©** ÙˆÙƒÙŠÙÙŠØ© Ø§Ù„ØªØ¹Ø§Ù…Ù„ Ù…Ø¹Ù‡Ø§

## ğŸ› ï¸ Ø§Ù„Ø£Ø¯ÙˆØ§Øª Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©

```yaml
dependencies:
  dio: ^5.0.0
  flutter_secure_storage: ^9.0.0  # Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù€ tokens
  shared_preferences: ^2.2.0      # Ù„Ù„ØªØ®Ø²ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠ
```

---

> **Ù…Ù„Ø§Ø­Ø¸Ø©**: Ù‡Ø°Ø§ Ø§Ù„ØªÙˆØ«ÙŠÙ‚ Ù…Ø®ØµØµ Ù„Ù„Ù€ **ØªØ·Ø¨ÙŠÙ‚ Ø§Ù„Ø¹Ù…ÙŠÙ„ (Customer App)** ÙˆÙ„ÙŠØ³ Ù„Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©.
