version: '3.8'

services:
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ğŸš€ NestJS Application
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  tras-backend: # ØºÙŠØ±Øª Ø§Ù„Ø§Ø³Ù… Ù„ÙŠÙƒÙˆÙ† Ù…Ù…ÙŠØ²Ø§Ù‹
    build:
      context: .
      dockerfile: Dockerfile
    container_name: tras-backend
    restart: unless-stopped
    # Ù†Ø³ØªØ®Ø¯Ù… expose Ù„ÙƒÙŠ Ù„Ø§ ÙŠØªØ¹Ø§Ø±Ø¶ Ø§Ù„Ø¨ÙˆØ±Øª 3000 Ù…Ø¹ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚Ø§Øª Ø§Ù„Ø§Ø®Ø±Ù‰ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±
    expose:
      - '3000'
    env_file:
      - .env
    depends_on:
      - tras-redis
    networks:
      - web-network # Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØ© Ù„Ù„ØªÙˆØ§ØµÙ„ Ù…Ø¹ Nginx Proxy Manager
    volumes:
      - ./logs:/app/logs
      - ./uploads:/app/uploads

  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  # ğŸ”´ Redis Cache
  # â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
  tras-redis:
    image: redis:7-alpine
    container_name: tras-redis
    restart: unless-stopped
    # Redis Ù„Ø§ ÙŠØ­ØªØ§Ø¬ expose Ù„Ù„Ø¹Ø§Ù„Ù… Ø§Ù„Ø®Ø§Ø±Ø¬ÙŠØŒ ÙÙ‚Ø· Ø¯Ø§Ø®Ù„ÙŠØ§Ù‹ Ù„Ù„Ø¨Ø§Ùƒ Ø¥Ù†Ø¯
    expose:
      - '6379'
    volumes:
      - redis-data:/data
    networks:
      - web-network
    command: redis-server --appendonly yes

# Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ù…ÙˆØ¬ÙˆØ¯Ø© Ù…Ø³Ø¨Ù‚Ø§Ù‹ ÙÙŠ Ø§Ù„Ø³ÙŠØ±ÙØ±
networks:
  web-network:
    external: true

volumes:
  redis-data:
